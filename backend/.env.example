# Servidor
PORT=3000
NODE_ENV=development

# Base de datos
DATABASE_URL=postgresql://postgres:postgres@localhost:5433/spacegurumis
PGHOST=localhost
PGUSER=postgres
PGPASSWORD=postgres
PGDATABASE=spacegurumis
PGPORT=5433

# Auth
JWT_SECRET=changeme
JWT_EXPIRES_IN=7d
FRONTEND_BASE_URL=https://spacegurumis.lat

# Reverse proxy (Dokploy/Nginx)
# Set to true in production behind a proxy that sets X-Forwarded-For/X-Forwarded-Proto.
TRUST_PROXY=false

# Cookie auth (HttpOnly sessions)
# Note: This backend uses cookie auth only for protected endpoints (no Authorization: Bearer).
ACCESS_COOKIE_NAME=sg_access
REFRESH_COOKIE_NAME=sg_refresh
CSRF_COOKIE_NAME=sg_csrf

# Cookie attributes
# In production, set COOKIE_SECURE=true (HTTPS).
COOKIE_SECURE=false
COOKIE_SAMESITE=lax
# Optional. Only set if you need to share cookies across subdomains (e.g. api.* + www.*).
COOKIE_DOMAIN=
COOKIE_PATH=/

# Cookie expirations (JWT-style, e.g. 15m, 7d, 30d). Leave empty to use JWT_EXPIRES_IN.
AUTH_COOKIE_ACCESS_EXPIRES_IN=
AUTH_COOKIE_REFRESH_ENABLED=false
AUTH_COOKIE_REFRESH_EXPIRES_IN=30d

# CSRF (only enforced for cookie-authenticated mutating requests)
# Comma-separated origins (no trailing slash). Example:
# CSRF_ALLOWED_ORIGINS=https://spacegurumis.lat,http://localhost:4321
CSRF_ALLOWED_ORIGINS=
CSRF_REQUIRE_TOKEN=true

# CORS (browser origins)
# Comma-separated origins. If empty/unset, the backend uses the default hardcoded allowlist.
# Example (prod): CORS_ALLOWED_ORIGINS=https://spacegurumis.lat,https://www.spacegurumis.lat
# Example (dev):  CORS_ALLOWED_ORIGINS=http://localhost:4321,http://127.0.0.1:4321
CORS_ALLOWED_ORIGINS=

# Auth rate limiting (in-memory per instance)
AUTH_RATE_LIMIT_WINDOW_MS=60000
AUTH_RATE_LIMIT_LOGIN_MAX=10
AUTH_RATE_LIMIT_REGISTER_MAX=5
AUTH_RATE_LIMIT_VERIFY_EMAIL_MAX=10
AUTH_RATE_LIMIT_RESEND_MAX=5
AUTH_RATE_LIMIT_ADMIN_2FA_MAX=10
AUTH_RATE_LIMIT_REFRESH_MAX=20

# Google OAuth
GOOGLE_CLIENT_ID=changeme
GOOGLE_CLIENT_SECRET=changeme
GOOGLE_CALLBACK_URL=http://localhost:3000/api/v1/auth/google/callback

# WhatsApp
WHATSAPP_NUMBER=51999999999
WHATSAPP_MESSAGE_TEMPLATE="Hola, soy {firstName} {lastName} (email: {email}). Mi pedido #{orderCode} incluye: {itemsSummary}. Total pagado: S/ {total}. Quiero coordinar la entrega por este chat."

# Stripe
STRIPE_SECRET_KEY=sk_test_changeme
STRIPE_WEBHOOK_SECRET=whsec_changeme
STRIPE_PUBLISHABLE_KEY=pk_test_changeme
STRIPE_SUCCESS_URL=https://spacegurumis.lat/
STRIPE_CANCEL_URL=https://spacegurumis.lat/cart

# Cloudflare R2 (product images)
# Tip: Configure a public custom domain for serving assets and set R2_PUBLIC_BASE_URL without trailing slash.
R2_ACCOUNT_ID=changeme
R2_ENDPOINT=https://<accountid>.r2.cloudflarestorage.com
R2_REGION=auto
R2_BUCKET=spacegurumis
R2_ACCESS_KEY_ID=changeme
R2_SECRET_ACCESS_KEY=changeme
R2_PUBLIC_BASE_URL=https://assets.spacegurumis.lat

# Presigned upload policy
R2_PRESIGN_EXPIRES_SECONDS=120
R2_ALLOWED_IMAGE_CONTENT_TYPES=image/jpeg,image/png,image/webp,image/avif
R2_MAX_IMAGE_BYTES=5242880

# Operacion
PAYMENT_HOLD_MINUTES=3
DEFAULT_SHIPPING_COST=10
HIGH_SHIPPING_COST=15
HIGH_SHIPPING_DISTRICTS="Puente Piedra,Carabayllo,Ventanilla,Villa El Salvador,San Juan de Miraflores"

# Resend
EMAIL_VERIFICATION_TTL_MINUTES=10
RESEND_API_KEY=re_changeme
RESEND_FROM="Spacegurumis <no-reply@spacegurumis.lat>"

# Admin
ADMIN_EMAILS="admin@spacegurumis.com,rony.ng.2011@gmail.com"
ADMIN_BOOTSTRAP_PASSWORD=admin1234
ADMIN_2FA_TTL_MINUTES=10
ADMIN_2FA_MAX_ATTEMPTS=5
ADMIN_2FA_LOCK_MINUTES=15
