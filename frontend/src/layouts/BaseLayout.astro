---
import '../styles/fonts.css';
import '../styles/global.css';

type Props = {
    title?: string;
    description?: string;
    navigationMode?: 'auto' | 'public' | 'admin' | 'none';
};

const {
    title = 'Spacegurumis',
    description = 'Spacegurumis',
    navigationMode = 'auto',
} = Astro.props as Props;

const pathname = Astro.url.pathname;
const inferredNavigationMode =
    pathname.startsWith('/admin') || pathname === '/admin-2fa'
        ? 'admin'
        : 'public';
const resolvedNavigationMode =
    navigationMode === 'auto' ? inferredNavigationMode : navigationMode;
---

<!doctype html>
<html lang="es">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>{title}</title>
        <meta name="description" content={description} />
        <link rel="icon" href="/alien.ico" sizes="any" />
    </head>
    <body class={`layout layout--${resolvedNavigationMode}`}>
        <a class="skip-link" href="#main">Saltar al contenido</a>

        <header class="site-header">
            <div class="container site-header__inner">
                <a class="brand" href="/" data-nav-prefetch>
                    <span class="brand__mark" aria-hidden="true">
                        <img src="/alienprincipal.png" alt="" class="brand__logo" />
                    </span>
                    <span class="brand__text">Spacegurumis</span>
                </a>

                {
                    resolvedNavigationMode === 'public' ? (
                        <nav class="nav" aria-label="Navegacion principal">
                            <a class="nav__link" href="/" data-nav-prefetch>Inicio</a>
                            <a class="nav__link" href="/shop" data-nav-prefetch>Tienda</a>
                            <a class="nav__link" href="/cart" data-nav-prefetch>Carrito</a>
                            <a class="nav__link" href="/orders" data-nav-prefetch>Mis pedidos</a>
                            <a class="nav__link" href="/profile" data-nav-prefetch>Perfil</a>
                            <a class="nav__link" href="/login" data-nav-prefetch>Login</a>
                            <a class="nav__link nav__link--cta" href="/register" data-nav-prefetch>Crear cuenta</a>
                        </nav>
                    ) : null
                }

                {
                    resolvedNavigationMode === 'admin' ? (
                        <nav class="nav nav--admin" aria-label="Navegacion admin">
                            <a class="nav__link" href="/" data-nav-prefetch>Ver tienda</a>
                            <a class="nav__link nav__link--cta" href="/admin" data-nav-prefetch>Panel admin</a>
                        </nav>
                    ) : null
                }
            </div>
        </header>

        <main id="main" class="container">
            <slot />
        </main>

        <footer class="site-footer">
            <div class="container site-footer__inner">
                <p class="muted">Â© {new Date().getFullYear()} Spacegurumis</p>
            </div>
        </footer>

        <script type="module">
            import { initAcceleratedNavigation } from '../lib/navigation/acceleratedNavigation';

            initAcceleratedNavigation();
        </script>
    </body>
</html>
